<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Apex Auto Pros - Add Tip</title>
    <!-- The QR Code library is now embedded at the bottom of the file -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            -webkit-tap-highlight-color: transparent;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
            box-sizing: border-box;
        }
        h1, h2 {
            margin: 0 0 20px 0;
            color: #1c1c1e;
        }
        .total-display {
            font-size: 2.5em;
            font-weight: bold;
            color: #000;
            margin-bottom: 25px;
        }
        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        .button {
            background-color: #007aff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 20px 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .button:active {
            background-color: #0056b3;
        }
        .button.full-width {
            grid-column: 1 / -1;
        }
        .percentage {
            font-size: 1.4em;
            margin-bottom: 5px;
        }
        .amount {
            font-size: 0.9em;
            opacity: 0.8;
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
        input[type="number"] {
            font-size: 2em;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            text-align: center;
            border: 2px solid #ccc;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .set-total-btn {
            width: 100%;
            padding: 20px;
            font-size: 1.2em;
        }
        #qr-code-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .qr-code-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .qr-code-box canvas, .qr-code-box img {
            border: 1px solid #eee;
        }
        .qr-code-box p {
            margin-top: 10px;
            font-weight: 600;
            color: #333;
        }
        #final-total-display {
            font-size: 2em;
            font-weight: bold;
        }
        #back-button {
            margin-top: 20px;
            background-color: #6c757d;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- SCREEN 1: EMPLOYEE ENTERS TOTAL -->
        <div id="input-screen" class="screen active">
            <h1>Enter Invoice Total</h1>
            <input type="number" id="invoice-total-input" placeholder="e.g., 542.50" step="0.01" inputmode="decimal">
            <button class="button set-total-btn" onclick="startTipping()">Set Total & Show Customer</button>
        </div>

        <!-- SCREEN 2: CUSTOMER ADDS TIP -->
        <div id="tip-screen" class="screen">
            <div id="total-display" class="total-display">$0.00</div>
            <h2>Add a tip?</h2>
            <div class="button-grid">
                <button class="button" onclick="selectTip(0.15)">
                    <div class="percentage">15%</div>
                    <div class="amount" id="tip-15-amount">$0.00</div>
                </button>
                <button class="button" onclick="selectTip(0.20)">
                    <div class="percentage">20%</div>
                    <div class="amount" id="tip-20-amount">$0.00</div>
                </button>
                <button class="button" onclick="selectTip(0.25)">
                    <div class="percentage">25%</div>
                    <div class="amount" id="tip-25-amount">$0.00</div>
                </button>
                <button class="button full-width" onclick="selectTip('custom')">Custom</button>
                <button class="button full-width" style="background-color:#555;" onclick="selectTip(0)">No tip</button>
            </div>
        </div>

        <!-- SCREEN 3: SHOW QR CODES -->
        <div id="qr-screen" class="screen">
            <h2>Scan to Pay</h2>
            <div id="final-total-display">$0.00</div>
            <div id="qr-code-container">
                <!-- QR Codes will be generated here -->
            </div>
            <button id="back-button" class="button full-width" onclick="resetApp()">Start New Payment</button>
        </div>
    </div>

<!-- EMBEDDED QR CODE LIBRARY - This makes the page self-contained -->
<script type="text/javascript">
var QRCode;!function(){function t(t){this.mode=l.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;e<r;e++){var i=this.data.charCodeAt(e);i>65536?this.parsedData.push(240|(1835008&i)>>>18,128|(258048&i)>>>12,128|(4032&i)>>>6,128|63&i):i>2048?this.parsedData.push(224|(61440&i)>>>12,128|(4032&i)>>>6,128|63&i):i>128?this.parsedData.push(192|(1984&i)>>>6,128|63&i):this.parsedData.push(i)}}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var i=0;i<t.length-r;i++)this.num[i]=t[i+r]}function i(t,e){this.totalCount=t,this.dataCount=e}function n(){this.buffer=[],this.length=0}function o(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var t=-1,e=-1,r=-1,i=-1;return function(){if(-1==t){var n=/([0-9]+)\.([0-9]+)\.([0-9]+)/,o=navigator.userAgent,a=null;if(null!=(a=o.match(/Opera\/([0-9]+)\.([0-9]+)/))&&a.length>2)t=parseInt(a[1]),e=parseInt(a[2]);else if(null!=(a=o.match(/MSIE ([0-9]+)\.([0-9]+)/))&&a.length>2)t=parseInt(a[1]),e=parseInt(a[2]);else if(null!=(a=o.match(/Trident\/.+rv:([0-9]+)\.([0-9]+)/))&&a.length>2)t=parseInt(a[1]),e=parseInt(a[2]);else if(null!=(a=o.match(/Chrome\/([0-9]+)\.([0-9]+)\.([0-9]+)/))&&a.length>3)t=parseInt(a[1]),e=parseInt(a[2]),r=parseInt(a[3]);else if(null!=(a=o.match(/AppleWebKit\/([0-9]+)\.([0-9]+)\.([0-9]+)/))&&a.length>3)t=parseInt(a[1]),e=parseInt(a[2]),r=parseInt(a[3]),null!=(a=o.match(/Version\/([0-9]+)\.([0-9]+)\.([0-9]+)/))&&a.length>3&&(i=parseInt(a[1]));else if(null!=(a=o.match(/Mozilla\/([0-9]+)\.([0-9]+)/))&&a.length>2)t=parseInt(a[1]),e=parseInt(a[2]);else if(null!=(a=o.match(/Firefox\/([0-9]+)\.([0-9]+)/))&&a.length>2)t=parseInt(a[1]),e=parseInt(a[2]);return}return{isOpera:t>=0&&t<=9&&void 0!==window.opera,isIE:t>0&&t<12,isChrome:t>=525&&t<538&&r>=9522||t>=538,isSafari:t>=525&&t<538&&i>=3,isFirefox:t>=1&&e>=9,isSupportVML:"function"==typeof document.createElement("div").insertAdjacentHTML}}()function s(t){var e=a();if(e.isIE&&t.setAttribute("height",t.height),e.isSafari)return!0;var r=document.createElement("canvas");if(!r.getContext)return!1;var i=r.getContext("2d"),n=t.width,o=t.height;return i.clearRect(0,0,n,o),i.drawImage(t,0,0),0==i.getImageData(0,0,1,1).data[3]}function h(t,e){var r=1,i=s(e);i&&(r=2);for(var n=e.width,o=e.height,a=Math.floor((t.width-n*r)/2),h=Math.floor((t.height-o*r)/2),l=t.getContext("2d"),u=0;u<o;u++)for(var c=0;c<n;c++){var f=l.getImageData(a+c*r,h+u*r,r,r),d=0,g=0;if(i)for(var v=0;v<r;v++)for(var m=0;m<r;m++)d+=f.data[4*(v*r+m)],g+=f.data[4*(v*r+m)+3];else d=f.data[0],g=f.data[3];d/=r*r,g/=r*r;var p=Math.round(255*Math.min(1,.9+Math.max(0,1-g/255)*(d/255-1)));l.fillStyle="rgb("+p+","+p+","+p+")",l.fillRect(a+c*r,h+u*r,r,r)}}t.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var r=new t(e);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[i][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,r),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(t,e){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(r>=0&&r<=6&&(0==i||6==i)||i>=0&&i<=6&&(0==r||6==r)||r>=2&&r<=4&&i>=2&&i<=4?this.modules[t+r][e+i]=!0:this.modules[t+r][e+i]=!1)},getBestMaskPattern:function(){for(var t=0,r=0,i=0;i<8;i++){this.makeImpl(!0,i);var n=u.getLostPoint(this);(0==i||t>n)&&(t=n,r=i)}return r},createMovieClip:function(t,e,r){var i=t.createEmptyMovieClip(e,r),n=1;this.make();for(var o=0;o<this.moduleCount;o++)for(var a=o*n,s=0;s<this.moduleCount;s++){var h=s*n,l=this.modules[o][s];l&&(i.beginFill(0,100),i.moveTo(h,a),i.lineTo(h+n,a),i.lineTo(h+n,a+n),i.lineTo(h,a+n),i.endFill())}return i},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=u.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var i=t[e],n=t[r];if(null==this.modules[i][n])for(var o=-2;o<=2;o++)for(var a=-2;a<=2;a++)-2==o||2==o||-2==a||2==a||0==o&&0==a?this.modules[i+o][n+a]=!0:this.modules[i+o][n+a]=!1}},setupTypeNumber:function(t){for(var e=u.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var i=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=i}for(var r=0;r<18;r++){var i=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=i}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,i=u.getBCHTypeInfo(r),n=0;n<15;n++){var o=!t&&1==(i>>n&1);n<6?this.modules[n][8]=o:n<8?this.modules[n+1][8]=o:this.modules[this.moduleCount-15+n][8]=o}for(var n=0;n<15;n++){var o=!t&&1==(i>>n&1);n<8?this.modules[8][this.moduleCount-n-1]=o:n<9?this.modules[8][15-n-1+1]=o:this.modules[8][15-n-1]=o}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,i=this.moduleCount-1,n=7,o=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;s<2;s++)if(null==this.modules[i][a-s]){var h=!1;o<t.length&&(h=1==(t[o]>>>n&1));u.getMask(e,i,a-s)&&(h=!h),this.modules[i][a-s]=h,n--,-1==n&&(o++,n=7)}if((i+=r)<0||this.moduleCount<=i){i-=r,r=-r;break}}}},e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,57,36,4,58,37],[4,43,19,4,44,20],[4,24,15,2,25,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9
